#!/usr/bin/env python3.3
# -*- coding: utf8 -*-
#
# Visualizes the enhanced nmap results

# Copyright (c) 2015	NorthernSec
# Copyright (c)	2015	Pieter-Jan Moreels
# This software is licensed under the Original BSD License

# Imports
import os
import sys
import json
runpath=os.path.dirname(os.path.realpath(__file__))
sys.path.append(os.path.join(runpath, '..'))

from jinja2 import Environment, FileSystemLoader
from weasyprint import HTML

env = Environment(loader=FileSystemLoader(os.path.join(runpath, '.')))
template = env.get_template("templates/pdf.html")
stylesheets = []
for style in ["bootstrap.min.css","style.css","flaticon.css"]:
  stylesheets.append(os.path.join(runpath, "static/css/", style))

def pdfify(enhanced):
  html_out = template.render(enhanced)
  HTML(string=html_out).write_pdf("report.pdf",
                                  stylesheets=stylesheets)

x = json.loads(open("analyzed.json").read())
pdfify(x)
