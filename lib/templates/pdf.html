<!doctype html>
<html lang="en">
<head>
  <title>Vulnerabilities for scanned systems</title>
  <!-- metadata -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Vulnerabilities for scanned system"/>
  <meta name="author" content="NorthernSec"/>
</head>
<body>
  <div class="well">
    <table>
      <tr><td>Scanned on</td><td>{{scan['time']}}</td></tr>
      <tr><td>Enhanced on</td><td>{{enhanced['time']}}</td></tr>
    </table>
  </div>
  {% if systems|length == 0 %}
    <div class="well">No hosts were scanned.</div>
  {% else %}
    {% for sys in systems %}
      {% set appendix = 1 %}
      <table class="table table-condensed table-striped">
        <tr><td class="warning">IP</td>     <td>{{sys['ip']}}</td></tr>
        <tr><td class="warning">MAC</td>    <td>{{sys['mac']}}</td></tr>
        <tr><td class="warning">Status</td> <td>{{sys['status']}}</td></tr>
        <tr><td class="warning">Possible CPEs</td>
            <td>
              {% if sys['cpes']|length == 0 %}
                System not recognized
              {% else %}
                <ul>
                  {%for cpe in sys['cpes'] %}
                    <li>{{ cpe['cpe'] }}
                        {% if cpe['cves']|length!=0 %}<span class="referal">* Vulns in Appendix {{ appendix }}</span>
                          {% set appendix = appendix +1 %}
                        {% endif %}</li>
                  {% endfor %}
                </ul>
              {% endif %}
            </td>
        </tr>
        {% if sys['status']=='up'%}
          <tr><td class="warning">Vendor</td> <td>{{sys['vendor']}}</td></tr>
          <tr><td class="warning">Hostnames</td> 
              <td>
                <ul>
                  {% for h in sys['hostnames'] %}<li>{{h}}</li>{% endfor %}
                </ul>
              </td>
          </tr>
          <tr><td class="warning">Distance</td>  <td>{{sys['distance']}}</td></tr>
          <tr><td class="warning">Services</td>
              <td>
                {% if sys['services']|length == 0 %}
                  No services found for this host
                {% else %}
                  <table class="table table-hover table-striped services">
                    <thead>
                      <tr class="warning"><td>Service</td><td>Product</td><td>Port/Protocol</td><td>Status</td><td>Appendix</td></tr>
                    </thead>
                    {% for s in sys['services'] %}
                      <tr>
                        <td>{{s['name']}}</td>
                        <td>{{s['banner']}}</td>
                        <td>port {{s['port']}}/{{s['protocol']}}</td>
                        <td>{{s['state']}}</td>
                        <td class="nonfluid">
                          {% if s['cves']|length!=0 %}
                            {{ appendix }}
                            {% set appendix = appendix +1 %}
                          {% endif %}
                        </td>
                      </tr>
                    {% endfor %}
                  </table>
                {% endif %}
              </td>
          </tr>
        {% endif %}
      </table>
    {% endfor %}
  {% endif %}
</body>
</html>
